#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -e
set -o pipefail

[[ -n $LUVIT_VERSION ]] || LUVIT_VERSION="0.7.0"

BUILD_DIR=$1
CACHE_DIR=$2

cd $BUILD_DIR

LUVIT_URL="http://luvit.io/dist/latest/ubuntu-latest/x86_64/luvit-bundled"
LUI_URL="https://github.com/dvv/luvit-lui/raw/master/lui"

echo "-----> Fetching luvm from $LUVIT_URL "
mkdir -p bin/

curl --silenmvt -O --max-time 60 --location "$LUVIT_URL" -o bin/luvit
chmod +x bin/luvit

echo "-----> Fetching lui from $LUI_URL "

curl --silent -O --max-time 60 --location "$LUI_URL" -o bin/lui
chmod +x lui
